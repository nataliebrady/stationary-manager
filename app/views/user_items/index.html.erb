<% provide(:title, 'Order history list') %>

<% if current_user.admin? && !current_user?(@user) %>
<h2>Order history</h2><br>
<% else %>
<h2>Your order history</h2><br>
<% end %>

<%= will_paginate %>

<br>

<!-- displaying the orders with different filters, for example - all orders not returned, all orders returned etc. -->

<ul class="nav nav-tabs">
  <li class="active"><a data-toggle="tab" href="#home">All</a></li>
  <li><a data-toggle="tab" href="#menu1">All used items</a></li>
  <li><a data-toggle="tab" href="#menu2">All borrowed items</a></li>
  <li><a data-toggle="tab" href="#menu3">All borrowed items returned</a></li>
  <li><a data-toggle="tab" href="#menu4">All borrowed items not returned</a></li>
</ul>

<br>

<div class="tab-content">
  <div id="home" class="tab-pane fade in active">
    <% if current_user.admin == false %>

  		 <% @all_user_items.each do |item| %>
  		 	<%= link_to item.item.name, item %>

  		 	<% if current_user.admin? && !current_user?(@user) %>
  		 	<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

  		 <% end %>

	<% else %>
  		
  		 <% @user_items.each do |item| %>
  		 	<%= link_to item.item.name, item %>

  		 	<% if current_user.admin? && !current_user?(@user) %>
  		 	<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

  		 <% end %>

	<% end %>
  </div>
  <div id="menu1" class="tab-pane fade">
    <% if current_user.admin == false %>
 		<% @all_user_items.returned.each do |item| %>

	 		<% if item.item.borrowable == false %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	
 	<% else %> 
 		<% @user_items.returned.each do |item| %>

	 		<% if item.item.borrowable == false %>
	 		<%= link_to item.item.name, item %>

			<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	<% end %>
  </div>
  <div id="menu2" class="tab-pane fade">
    <% if current_user.admin == false %>
 		<% @all_user_items.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

			<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	
 	<% else %> 
 		<% @user_items.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
  		 	<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	<% end %>
  </div>
    <div id="menu3" class="tab-pane fade">
    <% if current_user.admin == false %>
 		<% @all_user_items.returned.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	
 	<% else %> 
 		<% @user_items.returned.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	<% end %>
  </div>
     <div id="menu4" class="tab-pane fade">
    <% if current_user.admin == false %>
 		<% @all_user_items.not_returned.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	
 	<% else %> 
 		<% @user_items.not_returned.each do |item| %>

	 		<% if item.item.borrowable == true %>
	 		<%= link_to item.item.name, item %>

	 		<% if current_user.admin? && !current_user?(@user) %>
	 		<div class="action-links">
  		 	<%= link_to "delete", item, class: 'btn btn-login btn-action', method: :delete,
                                  data: { confirm: "You sure?" } %>
            </div>
            <% end %>

            <br><br><br>

	 		<% end %>

 		<% end %>
 	<% end %>
  </div>
</div>
<%= will_paginate %>


